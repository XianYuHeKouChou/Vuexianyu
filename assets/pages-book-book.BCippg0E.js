import{_ as t,o as e,A as s,w as o,b as l,B as i,G as a,e as n,h as u,i as c,M as r,R as d,r as h,a as f,c as b,F as m,T as p,t as g,C as x,d as _,f as y,U as k}from"./index-Dk3PNdqW.js";import{_ as $}from"./uni-section.BsMU0R0B.js";import{_ as C}from"./uni-icons.DIvzvsbo.js";const L=t({name:"UniNumberBox",emits:["change","input","update:modelValue","blur","focus"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},background:{type:String,default:"#f5f5f5"},color:{type:String,default:"#333"},disabled:{type:Boolean,default:!1},width:{type:Number,default:40}},data:()=>({inputValue:0}),watch:{value(t){this.inputValue=+t},modelValue(t){this.inputValue=+t}},computed:{widthWithPx(){return this.width+"px"}},created(){1===this.value&&(this.inputValue=+this.modelValue),1===this.modelValue&&(this.inputValue=+this.value)},methods:{_calcValue(t){if(this.disabled)return;const e=this._getDecimalScale();let s=this.inputValue*e,o=this.step*e;if("minus"===t){if(s-=o,s<this.min*e)return;s>this.max*e&&(s=this.max*e)}if("plus"===t){if(s+=o,s>this.max*e)return;s<this.min*e&&(s=this.min*e)}this.inputValue=(s/e).toFixed(String(e).length-1),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue),this.$emit("change",+this.inputValue)},_getDecimalScale(){let t=1;return~~this.step!==this.step&&(t=Math.pow(10,String(this.step).split(".")[1].length)),t},_onBlur(t){this.$emit("blur",t);let e=t.detail.value;if(isNaN(e))return void(this.inputValue=this.value);e=+e,e>this.max?e=this.max:e<this.min&&(e=this.min);const s=this._getDecimalScale();this.inputValue=e.toFixed(String(s).length-1),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue),this.$emit("change",+this.inputValue)},_onFocus(t){this.$emit("focus",t)}}},[["render",function(t,d,h,f,b,m){const p=u,g=c,x=r;return e(),s(g,{class:"uni-numbox"},{default:o((()=>[l(g,{onClick:d[0]||(d[0]=t=>m._calcValue("minus")),class:"uni-numbox__minus uni-numbox-btns",style:i({background:h.background})},{default:o((()=>[l(p,{class:a(["uni-numbox--text",{"uni-numbox--disabled":b.inputValue<=h.min||h.disabled}]),style:i({color:h.color})},{default:o((()=>[n("-")])),_:1},8,["class","style"])])),_:1},8,["style"]),l(x,{disabled:h.disabled,onFocus:m._onFocus,onBlur:m._onBlur,class:"uni-numbox__value",type:h.step<1?"digit":"number",modelValue:b.inputValue,"onUpdate:modelValue":d[1]||(d[1]=t=>b.inputValue=t),style:i({background:h.background,color:h.color,width:m.widthWithPx})},null,8,["disabled","onFocus","onBlur","type","modelValue","style"]),l(g,{onClick:d[2]||(d[2]=t=>m._calcValue("plus")),class:"uni-numbox__plus uni-numbox-btns",style:i({background:h.background})},{default:o((()=>[l(p,{class:a(["uni-numbox--text",{"uni-numbox--disabled":b.inputValue>=h.max||h.disabled}]),style:i({color:h.color})},{default:o((()=>[n("+")])),_:1},8,["class","style"])])),_:1},8,["style"])])),_:1})}],["__scopeId","data-v-91750ff9"]]),V={en:{"uni-goods-nav.options.shop":"shop","uni-goods-nav.options.cart":"cart","uni-goods-nav.buttonGroup.addToCart":"add to cart","uni-goods-nav.buttonGroup.buyNow":"buy now"},"zh-Hans":{"uni-goods-nav.options.shop":"店铺","uni-goods-nav.options.cart":"购物车","uni-goods-nav.buttonGroup.addToCart":"加入购物车","uni-goods-nav.buttonGroup.buyNow":"立即购买"},"zh-Hant":{"uni-goods-nav.options.shop":"店鋪","uni-goods-nav.options.cart":"購物車","uni-goods-nav.buttonGroup.addToCart":"加入購物車","uni-goods-nav.buttonGroup.buyNow":"立即購買"}},{t:v}=d(V);const w=t({name:"UniGoodsNav",emits:["click","buttonClick"],props:{options:{type:Array,default:()=>[{icon:"shop",text:v("uni-goods-nav.options.shop")},{icon:"cart",text:v("uni-goods-nav.options.cart")}]},buttonGroup:{type:Array,default:()=>[{text:v("uni-goods-nav.buttonGroup.addToCart"),backgroundColor:"linear-gradient(90deg, #FFCD1E, #FF8A18)",color:"#fff"},{text:v("uni-goods-nav.buttonGroup.buyNow"),backgroundColor:"linear-gradient(90deg, #FE6035, #EF1224)",color:"#fff"}]},fill:{type:Boolean,default:!1},stat:{type:Boolean,default:!1}},methods:{onClick(t,e){this.$emit("click",{index:t,content:e})},buttonClick(t,e){uni.report&&this.stat&&uni.report(e.text,e.text),this.$emit("buttonClick",{index:t,content:e})}}},[["render",function(t,r,d,_,y,k){const $=c,L=h(f("uni-icons"),C),V=u;return e(),s($,{class:"uni-goods-nav"},{default:o((()=>[l($,{class:"uni-tab__seat"}),l($,{class:"uni-tab__cart-box flex"},{default:o((()=>[l($,{class:"flex uni-tab__cart-sub-left"},{default:o((()=>[(e(!0),b(m,null,p(d.options,((t,u)=>(e(),s($,{key:u,class:"flex uni-tab__cart-button-left uni-tab__shop-cart",onClick:e=>k.onClick(u,t)},{default:o((()=>[l($,{class:"uni-tab__icon"},{default:o((()=>[l(L,{type:t.icon,size:"20",color:"#646566"},null,8,["type"])])),_:2},1024),l(V,{class:"uni-tab__text"},{default:o((()=>[n(g(t.text),1)])),_:2},1024),l($,{class:"flex uni-tab__dot-box"},{default:o((()=>[t.info?(e(),s(V,{key:0,class:a([{"uni-tab__dots":t.info>9},"uni-tab__dot"]),style:i({backgroundColor:t.infoBackgroundColor?t.infoBackgroundColor:"#ff0000",color:t.infoColor?t.infoColor:"#fff"})},{default:o((()=>[n(g(t.info),1)])),_:2},1032,["class","style"])):x("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),l($,{class:a([{"uni-tab__right":d.fill},"flex uni-tab__cart-sub-right"])},{default:o((()=>[(e(!0),b(m,null,p(d.buttonGroup,((t,a)=>(e(),s($,{key:a,style:i({background:t.backgroundColor,color:t.color}),class:"flex uni-tab__cart-button-right",onClick:e=>k.buttonClick(a,t)},{default:o((()=>[l(V,{style:i({color:t.color}),class:"uni-tab__cart-button-right-text"},{default:o((()=>[n(g(t.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onClick"])))),128))])),_:1},8,["class"])])),_:1})])),_:1})}],["__scopeId","data-v-c4a09ec4"]]);const N=t({data:()=>({leftListIndex:null,rightListScollTo:"",options:[{icon:"cart",text:"购物车",info:0},{icon:"shop",text:"￥0"}],customButtonGroup1:[{text:"立即购买",backgroundColor:"linear-gradient(90deg, #FE6035, #EF1224)",color:"#fff"}]}),onReady(){this.getMenuList()},onshow(){this.$req.ceshi=this.$refs.loadToast},methods:{getMenuList(){this.$req.httpGet("/api/test-item-maps",{},(t=>{this.$global.menuList=t.data,this.getMenuDetailList()}))},leftListClick(t){this.leftListIndex=t,this.rightListScollTo="menuItem"+t},getMenuDetailList(){this.$global.menuList.map((t=>{t.ListInfo=[],t.itemList.map((e=>{this.$req.httpGet("/api/test-meuns",{"filters[itemId][$eq]":e},(e=>{e.data[0].chooseNum=0,t.ListInfo.push(e.data[0])}))}))})),this.changeNum()},changeNum(t){this.$global.chooseStoreAction(),this.$global.chooseStorePriceAction(),this.$global.chooseStoreListAction(),this.options[0].info=this.$global.menuListTotalNum,this.options[1].text="￥"+this.$global.menuListTotalPrice},buyGoods(){return this.$global.menuListTotalNum<=0?this.$req.showToast("请选择商品后再下单"):this.$global.userInfo.userBalance<this.$global.menuListTotalPrice?this.$req.showToast("余额不足，请先充值"):void this.$req.httpPost("/api/test-histories",{data:{BuyList:this.$global.chooseMenuList,sumNum:this.$global.menuListTotalPrice,address:this.$global.chooseStore,getPoints:Number(this.$global.menuListTotalPrice).toFixed(0)}},(t=>{this.userDataChange()}))},userDataChange(){this.$req.httpPut("/api/test-user",{data:{userBalance:Number(this.$global.userInfo.userBalance)-this.$global.menuListTotalPrice,userPoints:Number(this.$global.userInfo.userPoints)+Number(Number(this.$global.menuListTotalPrice).toFixed(0))}},(t=>{this.$global.userInfo=t.data,this.$req.showToast("下单成功"),this.$global.clearChooseStoreList(),this.options[0].info=this.$global.menuListTotalNum,this.options[1].text="￥"+this.$global.menuListTotalPrice}))}}},[["render",function(t,i,r,d,C,V){const v=y,N=c,T=u,G=k,B=h(f("uni-section"),$),I=h(f("uni-number-box"),L),P=h(f("uni-goods-nav"),w),S=h(f("loading"),_);return e(),b(m,null,[l(N,{class:"flex-center bg-white p-30"},{default:o((()=>[l(v,{src:"/assets/logo-BGXo2rls.png",mode:"",class:"w-150 h-30",onClick:t.ceshi},null,8,["onClick"])])),_:1}),l(N,{class:"flex justif-between"},{default:o((()=>[l(G,{"scroll-y":!0,"scroll-with-animation":!0,class:"w-90",style:{height:"80vh"}},{default:o((()=>[(e(!0),b(m,null,p(t.$global.menuList,((t,i)=>(e(),s(N,{class:a(["flex-center flex-col list-box-top transition list-bg-grey",{"list-bg-red":C.leftListIndex===i,"p-8":C.leftListIndex===i,"p-15":C.leftListIndex!=i}]),key:i,onClick:t=>V.leftListClick(i)},{default:o((()=>[C.leftListIndex===i?(e(),s(v,{key:0,src:t.classPicUrl,class:"w-30 h-30"},null,8,["src"])):x("",!0),l(T,{class:a(["text-bold text-xs transition",{"text-white":C.leftListIndex===i}])},{default:o((()=>[n(g(t.className),1)])),_:2},1032,["class"])])),_:2},1032,["class","onClick"])))),128))])),_:1}),l(G,{"scroll-y":"true","scroll-with-animation":!0,"scroll-into-view":C.rightListScollTo,class:"flex-1"},{default:o((()=>[l(N,{class:"flex flex-col",style:{height:"80vh"}},{default:o((()=>[(e(!0),b(m,null,p(t.$global.menuList,((t,i)=>(e(),s(N,{class:"flex flex-col",key:i,id:"menuItem"+i},{default:o((()=>[l(B,{title:t.className,class:"pos-sticky"},null,8,["title"]),(e(!0),b(m,null,p(t.ListInfo,((t,i)=>(e(),s(N,{class:"flex justif-between p-10 list-box-bottom",key:i},{default:o((()=>[l(v,{src:t.itemPicture,class:"w-150 h-130"},null,8,["src"]),l(N,{class:"flex flex-col justif-between ml-5"},{default:o((()=>[l(N,{class:"flex flex-col",style:{"align-items":"flex-end"}},{default:o((()=>[l(T,{class:"text-base text-bold text2 w-100 text-right"},{default:o((()=>[n(g(t.itemName),1)])),_:2},1024)])),_:2},1024),l(N,{class:"flex flex-col",style:{"align-items":"flex-end"}},{default:o((()=>[l(T,{class:"text-xl text-bold",style:{color:"#e60001"}},{default:o((()=>[n("￥"+g(t.itemPrice),1)])),_:2},1024),l(I,{class:"mt-10",modelValue:t.chooseNum,"onUpdate:modelValue":e=>t.chooseNum=e,onChange:V.changeNum},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1032,["id"])))),128))])),_:1})])),_:1},8,["scroll-into-view"])])),_:1}),l(N,{class:"absolute b-0 w-full"},{default:o((()=>[l(P,{fill:!0,options:C.options,buttonGroup:C.customButtonGroup1,onButtonClick:V.buyGoods},null,8,["options","buttonGroup","onButtonClick"])])),_:1}),l(S,{ref:"loadToast"},null,512)],64)}],["__scopeId","data-v-7972dc3c"]]);export{N as default};
